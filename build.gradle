import com.marcnuri.yack.schema.api.ApiGeneratorTask
import com.marcnuri.yack.schema.model.ModelGeneratorTask

plugins {
  id 'java-library'
}

apply from: 'properties.gradle'

java {
  sourceCompatibility = JavaVersion.VERSION_1_8
  targetCompatibility = JavaVersion.VERSION_1_8
}

dependencies {
  compileOnly "org.projectlombok:lombok:$version_projectlombok"
  compile "com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:$version_jackson"
  compile "com.fasterxml.jackson.datatype:jackson-datatype-jsr310:$version_jackson"
  compile "com.squareup.retrofit2:converter-jackson:$version_retrofit"
  compile "com.squareup.retrofit2:retrofit:$version_retrofit"
  compile "io.reactivex.rxjava2:rxjava:$version_rxjava2"
  compile "org.bouncycastle:bcprov-jdk15on:$version_bouncycastle"
  annotationProcessor "org.projectlombok:lombok:$version_projectlombok"
  testImplementation "org.junit.jupiter:junit-jupiter-api:$version_junit"
  testImplementation "org.assertj:assertj-core:$version_assertj"
  testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:$version_junit"
}
sourceSets.main.java.srcDirs = ['src/api/java', 'src/main/java', 'src/model/java']

test {
  useJUnitPlatform()
}

def schemaDir = new File(projectDir, "schema")
task generateModel(type: ModelGeneratorTask) {
  group = 'generators'
  packageName = 'com.marcnuri.yakc'
  schema = new File(schemaDir, "kubernetes-1.16.0.json")
  templatesDir = new File(schemaDir, "templates")
  outputDirectory = projectDir
}
task generateApi(type: ApiGeneratorTask) {
  group = 'generators'
  packageName = 'com.marcnuri.yakc'
  schema = new File(schemaDir, "kubernetes-1.16.0.json")
  templatesDir = new File(schemaDir, "templates")
  outputDirectory = projectDir
}

import com.marcnuri.yack.schema.api.ApiGeneratorTask
import com.marcnuri.yack.schema.model.ModelGeneratorTask

plugins {
  id 'java-library'
}

apply from: 'properties.gradle'

java {
  sourceCompatibility = JavaVersion.VERSION_1_8
  targetCompatibility = JavaVersion.VERSION_1_8
}

dependencies {
  compileOnly "org.projectlombok:lombok:$version_projectlombok"
  compile "io.github.openfeign:feign-okhttp:$version_feign"
  compile "io.github.openfeign:feign-jackson:$version_feign"
  compile "io.github.openfeign:feign-slf4j:$version_feign"
  compile "com.fasterxml.jackson.datatype:jackson-datatype-jsr310:$version_jackson"
  annotationProcessor "org.projectlombok:lombok:$version_projectlombok"
  testImplementation "org.junit.jupiter:junit-jupiter-api:$version_junit"
  testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine:$version_junit"
}
sourceSets.main.java.srcDirs = ['src/api/java', 'src/main/java', 'src/model/java']

test {
  useJUnitPlatform()
}

def schemaDir = new File(projectDir, "schema");
task generateModel(type: ModelGeneratorTask) {
  group = 'generators'
  schema = new File(schemaDir, "kubernetes-1.16.0.json")
  templatesDir = new File(schemaDir, "templates")
  outputDirectory = projectDir
}
task generateApi(type: ApiGeneratorTask) {
  group = 'generators'
  packageName = 'com.marcnuri.yakc'
  schema = new File(schemaDir, "kubernetes-1.16.0.json")
  templatesDir = new File(schemaDir, "templates")
  outputDirectory = projectDir
}
